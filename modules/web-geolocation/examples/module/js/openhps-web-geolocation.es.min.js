import*as o from"./openhps-core.es.min.js";var t={d:(o,e)=>{for(var i in e)t.o(e,i)&&!t.o(o,i)&&Object.defineProperty(o,i,{enumerable:!0,get:e[i]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t)},e={};t.d(e,{R:()=>GeolocationSourceNode});const i=(o=>{var e={};return t.d(e,o),e})({Accuracy2D:()=>o.Accuracy2D,AngleUnit:()=>o.AngleUnit,DataFrame:()=>o.DataFrame,DataObject:()=>o.DataObject,GeographicalPosition:()=>o.GeographicalPosition,LengthUnit:()=>o.LengthUnit,LinearVelocity:()=>o.LinearVelocity,Orientation:()=>o.Orientation,SourceNode:()=>o.SourceNode});class GeolocationSourceNode extends i.SourceNode{constructor(o){var t;super(o),this.options.interval=this.options.interval||1e3,this.options.autoStart&&this.once("build",this.start.bind(this)),this.options.source=null!==(t=this.source)&&void 0!==t?t:new i.DataObject}start(){return new Promise(((o,t)=>{this.geolocation=navigator.geolocation,this.geolocation.watchPosition((o=>{const t=this._convertPosition(o);this.source.setPosition(t),this.push(new i.DataFrame(this.source))}),(o=>{this.logger("error","Unable to watch for position changes!",o),t(o)}),{maximumAge:this.options.interval,timeout:this.options.timeout,enableHighAccuracy:!0}),o()}))}_convertPosition(o){const t=new i.GeographicalPosition;return t.accuracy=new i.Accuracy2D(o.coords.accuracy,o.coords.altitudeAccuracy,i.LengthUnit.METER),t.altitude=o.coords.altitude,t.latitude=o.coords.latitude,t.longitude=o.coords.longitude,o.coords.speed&&(t.linearVelocity=new i.LinearVelocity(o.coords.speed)),o.coords.heading&&(t.orientation=i.Orientation.fromEuler({yaw:o.coords.heading,pitch:0,roll:0,unit:i.AngleUnit.DEGREE})),t}stop(){return new Promise((o=>{this.geolocation.clearWatch(this._watchId),o()}))}onPull(){return new Promise(((o,t)=>{this.geolocation.getCurrentPosition((t=>{const e=this._convertPosition(t);this.source.setPosition(e),o(new i.DataFrame(this.source))}),(o=>t(o)),{enableHighAccuracy:!0,timeout:this.options.timeout,maximumAge:this.options.timeout})}))}}var n=e.R;export{n as GeolocationSourceNode};
//# sourceMappingURL=openhps-web-geolocation.es.min.js.map