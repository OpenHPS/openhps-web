import*as e from"./openhps-core.es.min.js";var t={d:(e,r)=>{for(var i in r)t.o(r,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:r[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},r={};t.d(r,{_H:()=>d,JK:()=>T,E7:()=>P,SE:()=>p,cf:()=>b,kx:()=>u,oJ:()=>D,dz:()=>R,rV:()=>L,VZ:()=>s,mD:()=>n,C1:()=>E,Ah:()=>RelativeRSSIProcessing,Bu:()=>o});function i(e,t,r,i){var a,_=arguments.length,s=_<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,i);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(s=(_<3?a(s):_>3?a(t,r,s):a(t,r))||s);return _>3&&s&&Object.defineProperty(t,r,s),s}function a(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}Object.create;Object.create;const _=(e=>{var r={};return t.d(r,e),r})({DataFrame:()=>e.DataFrame,DataObject:()=>e.DataObject,LengthUnit:()=>e.LengthUnit,RelativeDistance:()=>e.RelativeDistance,RelativePosition:()=>e.RelativePosition,RelativePositionProcessing:()=>e.RelativePositionProcessing,SerializableArrayMember:()=>e.SerializableArrayMember,SerializableMember:()=>e.SerializableMember,SerializableObject:()=>e.SerializableObject});let s=class RFReceiverObject extends _.DataObject{};i([(0,_.SerializableMember)(),a("design:type",Number)],s.prototype,"rxSensitivity",void 0),s=i([(0,_.SerializableObject)()],s);let n=class RFTransmitterObject extends _.DataObject{constructor(e,t,r){super(e),this.calibratedRSSI=t,this.txPower=r}get calibratedRSSI(){var e;return null!==(e=this._calibratedRSSI)&&void 0!==e?e:this.txPower}set calibratedRSSI(e){if(e>0)throw new RangeError("Calibrated RSSI should be a number below 0");this._calibratedRSSI=e}get environmentFactor(){return this._environmentFactor}set environmentFactor(e){this._environmentFactor=e}};i([(0,_.SerializableMember)(),a("design:type",Number)],n.prototype,"txPower",void 0),i([(0,_.SerializableMember)(),a("design:type",Number)],n.prototype,"frequency",void 0),i([(0,_.SerializableMember)(),a("design:type",Number),a("design:paramtypes",[Number])],n.prototype,"calibratedRSSI",null),i([(0,_.SerializableMember)(),a("design:type",Number),a("design:paramtypes",[Number])],n.prototype,"environmentFactor",null),n=i([(0,_.SerializableObject)(),a("design:paramtypes",[String,Number,Number])],n);let o=class WLANObject extends n{};i([(0,_.SerializableMember)(),a("design:type",Number)],o.prototype,"channel",void 0),i([(0,_.SerializableMember)(),a("design:type",String)],o.prototype,"capabilities",void 0),o=i([(0,_.SerializableObject)()],o);let E=class RelativeRSSI extends _.RelativePosition{constructor(e,t){super(e,t)}get rssi(){return this.referenceValue}set rssi(e){this.referenceValue=e}};function c(e){if(e)return e.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),"")}function A(e){if(e)return Uint8Array.from(e.match(/.{1,2}/g).map((e=>parseInt(e,16))))}function l(e,t){return function(e,t){if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e.getUint8(r)!==t.getUint8(r))return!1;return!0}(new DataView(e),new DataView(t))}i([(0,_.SerializableMember)(),a("design:type",Number),a("design:paramtypes",[Number])],E.prototype,"rssi",null),E=i([(0,_.SerializableObject)(),a("design:paramtypes",[Object,Number])],E);let b=class BLEUUID{constructor(e){this._raw=e}static fromBuffer(e){return new this(e)}static fromString(e){return new this(Uint8Array.from(e.replace("-0000-1000-8000-00805f9b34fb","").replace(/^0000/,"").replace(/-/g,"").split(/(..)/).filter((e=>""!==e)).map((e=>Number(`0x${e}`)))))}toBuffer(){return this._raw}toString(){const e=[];for(const[,t]of this._raw.entries())e.push(t);if(2===this._raw.byteLength)return"0000"+e.map((e=>e.toString(16).padStart(2,"0"))).join("")+"-0000-1000-8000-00805f9b34fb";if(4===this._raw.byteLength)return e.map((e=>e.toString(16).padStart(2,"0"))).join("")+"-0000-1000-8000-00805f9b34fb";{const t=e.map((e=>e.toString(16).padStart(2,"0")));return t.splice(0,4).join("")+"-"+t.splice(0,2).join("")+"-"+t.splice(0,2).join("")+"-"+t.splice(0,2).join("")+"-"+t.join("")}}};i([(0,_.SerializableMember)({serializer:c,deserializer:A}),a("design:type",Uint8Array)],b.prototype,"_raw",void 0),b=i([(0,_.SerializableObject)(),a("design:paramtypes",[Uint8Array])],b);let p=class BLEService{constructor(e,t){this.uuid=e,this.data=t}};i([(0,_.SerializableMember)(),a("design:type",b)],p.prototype,"uuid",void 0),i([(0,_.SerializableMember)({serializer:c,deserializer:A}),a("design:type",Uint8Array)],p.prototype,"data",void 0),p=i([(0,_.SerializableObject)(),a("design:paramtypes",[b,Uint8Array])],p);let D=class MACAddress{constructor(e){this._raw=e}static fromBuffer(e){return new this(e)}static fromString(e){return new this(Uint8Array.from(e.replace(/:/g,"").split(/(..)/).filter((e=>""!==e)).map((e=>Number(`0x${e}`)))))}toBuffer(){return this._raw}toString(){const e=[];for(const[,t]of this._raw.entries())e.push(t);return e.map((e=>e.toString(16).padStart(2,"0"))).join(":")}};var S;i([(0,_.SerializableMember)({serializer:c,deserializer:A}),a("design:type",Uint8Array)],D.prototype,"_raw",void 0),D=i([(0,_.SerializableObject)(),a("design:paramtypes",[Uint8Array])],D),function(e){e[e.BLE_AD_TYPE_FLAG=1]="BLE_AD_TYPE_FLAG",e[e.BLE_AD_TYPE_16SRV_PART=2]="BLE_AD_TYPE_16SRV_PART",e[e.BLE_AD_TYPE_16SRV_CMPL=3]="BLE_AD_TYPE_16SRV_CMPL",e[e.BLE_AD_TYPE_32SRV_PART=4]="BLE_AD_TYPE_32SRV_PART",e[e.BLE_AD_TYPE_32SRV_CMPL=5]="BLE_AD_TYPE_32SRV_CMPL",e[e.BLE_AD_TYPE_128SRV_PART=6]="BLE_AD_TYPE_128SRV_PART",e[e.BLE_AD_TYPE_128SRV_CMPL=7]="BLE_AD_TYPE_128SRV_CMPL",e[e.BLE_AD_TYPE_NAME_SHORT=8]="BLE_AD_TYPE_NAME_SHORT",e[e.BLE_AD_TYPE_NAME_CMPL=9]="BLE_AD_TYPE_NAME_CMPL",e[e.BLE_AD_TYPE_TX_PWR=10]="BLE_AD_TYPE_TX_PWR",e[e.BLE_AD_TYPE_DEV_CLASS=13]="BLE_AD_TYPE_DEV_CLASS",e[e.BLE_AD_TYPE_SM_TK=16]="BLE_AD_TYPE_SM_TK",e[e.BLE_AD_TYPE_SM_OOB_FLAG=17]="BLE_AD_TYPE_SM_OOB_FLAG",e[e.BLE_AD_TYPE_INT_RANGE=18]="BLE_AD_TYPE_INT_RANGE",e[e.BLE_AD_TYPE_SOL_SRV_UUID=20]="BLE_AD_TYPE_SOL_SRV_UUID",e[e.BLE_AD_TYPE_128SOL_SRV_UUID=21]="BLE_AD_TYPE_128SOL_SRV_UUID",e[e.BLE_AD_TYPE_SERVICE_DATA=22]="BLE_AD_TYPE_SERVICE_DATA",e[e.BLE_AD_TYPE_PUBLIC_TARGET=23]="BLE_AD_TYPE_PUBLIC_TARGET",e[e.BLE_AD_TYPE_RANDOM_TARGET=24]="BLE_AD_TYPE_RANDOM_TARGET",e[e.BLE_AD_TYPE_APPEARANCE=25]="BLE_AD_TYPE_APPEARANCE",e[e.BLE_AD_TYPE_ADV_INT=26]="BLE_AD_TYPE_ADV_INT",e[e.BLE_AD_TYPE_LE_DEV_ADDR=27]="BLE_AD_TYPE_LE_DEV_ADDR",e[e.BLE_AD_TYPE_LE_ROLE=28]="BLE_AD_TYPE_LE_ROLE",e[e.BLE_AD_TYPE_SPAIR_C256=29]="BLE_AD_TYPE_SPAIR_C256",e[e.BLE_AD_TYPE_SPAIR_R256=30]="BLE_AD_TYPE_SPAIR_R256",e[e.BLE_AD_TYPE_32SOL_SRV_UUID=31]="BLE_AD_TYPE_32SOL_SRV_UUID",e[e.BLE_AD_TYPE_32SERVICE_DATA=32]="BLE_AD_TYPE_32SERVICE_DATA",e[e.BLE_AD_TYPE_128SERVICE_DATA=33]="BLE_AD_TYPE_128SERVICE_DATA",e[e.BLE_AD_TYPE_LE_SECURE_CONFIRM=34]="BLE_AD_TYPE_LE_SECURE_CONFIRM",e[e.BLE_AD_TYPE_LE_SECURE_RANDOM=35]="BLE_AD_TYPE_LE_SECURE_RANDOM",e[e.BLE_AD_TYPE_URI=36]="BLE_AD_TYPE_URI",e[e.BLE_AD_TYPE_INDOOR_POSITION=37]="BLE_AD_TYPE_INDOOR_POSITION",e[e.BLE_AD_TYPE_TRANS_DISC_DATA=38]="BLE_AD_TYPE_TRANS_DISC_DATA",e[e.BLE_AD_TYPE_LE_SUPPORT_FEATURE=39]="BLE_AD_TYPE_LE_SUPPORT_FEATURE",e[e.BLE_AD_TYPE_CHAN_MAP_UPDATE=40]="BLE_AD_TYPE_CHAN_MAP_UPDATE",e[e.BLE_AD_MANUFACTURER_SPECIFIC_TYPE=255]="BLE_AD_MANUFACTURER_SPECIFIC_TYPE"}(S||(S={}));let P=class BLEObject extends n{constructor(e){super(e?e instanceof D?e.toString():e:void 0),this.knownAddresses=[],e instanceof D&&(this.address=e,this.knownAddresses.includes(e)||void 0===e||this.knownAddresses.push(e))}parseScanData(e){const t=new DataView(e.buffer,0);for(let r=0;r<e.byteLength;r++){let i=t.getUint8(r++);if(0!=i){const a=t.getUint8(r++);switch(i--,a){case S.BLE_AD_TYPE_NAME_CMPL:this.displayName=(new TextDecoder).decode(e.buffer.slice(r,r+i));break;case S.BLE_AD_TYPE_TX_PWR:this.txPower=t.getInt8(r);break;case S.BLE_AD_TYPE_APPEARANCE:this.appearance=t.getUint16(r,!1);break;case S.BLE_AD_TYPE_FLAG:case S.BLE_AD_TYPE_16SRV_CMPL:case S.BLE_AD_TYPE_16SRV_PART:case S.BLE_AD_TYPE_32SRV_CMPL:case S.BLE_AD_TYPE_32SRV_PART:case S.BLE_AD_TYPE_128SRV_CMPL:case S.BLE_AD_TYPE_128SRV_PART:break;case S.BLE_AD_MANUFACTURER_SPECIFIC_TYPE:this.parseManufacturerData(new Uint8Array(e.buffer.slice(r,r+i)));break;case S.BLE_AD_TYPE_SERVICE_DATA:{const t=b.fromBuffer(new Uint8Array(e.buffer.slice(r,r+2)));this.services.push(new p(t,new Uint8Array(e.buffer.slice(r+2,r+2+i))));break}case S.BLE_AD_TYPE_32SERVICE_DATA:case S.BLE_AD_TYPE_128SERVICE_DATA:}r+=i-1}}return this}parseManufacturerData(e){return this.manufacturerData=e,this}};i([(0,_.SerializableMember)({serializer:c,deserializer:A}),a("design:type",Uint8Array)],P.prototype,"manufacturerData",void 0),i([(0,_.SerializableMember)(),a("design:type",D)],P.prototype,"address",void 0),i([(0,_.SerializableArrayMember)(D),a("design:type",Array)],P.prototype,"knownAddresses",void 0),i([(0,_.SerializableMember)(),a("design:type",Number)],P.prototype,"mtu",void 0),i([(0,_.SerializableMember)(),a("design:type",Number)],P.prototype,"appearance",void 0),i([(0,_.SerializableArrayMember)(p),a("design:type",Array)],P.prototype,"services",void 0),P=i([(0,_.SerializableObject)(),a("design:paramtypes",[Object])],P);let L=class RFDataFrame extends _.DataFrame{addRelativeRSSI(e,t){return!!this.source&&(this.source.addRelativePosition(new E(e,t)),this.addObject(e),!0)}};L=i([(0,_.SerializableObject)()],L);let T=class BLEBeaconObject extends P{constructor(e,t){super(e),t&&this.parseScanData(t)}};T=i([(0,_.SerializableObject)(),a("design:paramtypes",[D,Uint8Array])],T);let d=class BLEAltBeacon extends T{parseManufacturerData(e){const t=new DataView(e.buffer,0);return 26===e.byteLength&&l(e.buffer.slice(0,4),Uint8Array.from([76,0,2,21]).buffer)?(this.proximityUUID=b.fromBuffer(e.subarray(4,20)),this.txPower=t.getInt8(24),this.uid=Buffer.concat([this.proximityUUID.toBuffer()]).toString("hex"),this):this}};i([(0,_.SerializableMember)(),a("design:type",b)],d.prototype,"proximityUUID",void 0),d=i([(0,_.SerializableObject)()],d);let u=class BLEiBeacon extends T{constructor(e,t){super(e),t&&this.parseScanData(t)}parseManufacturerData(e){const t=new DataView(e.buffer,0);return 25===e.byteLength&&l(e.buffer.slice(0,4),Uint8Array.from([76,0,2,21]).buffer)?(this.proximityUUID=b.fromBuffer(e.subarray(4,20)),this.major=t.getUint16(20,!1),this.minor=t.getUint16(22,!1),this.txPower=t.getInt8(24),this.uid=(new TextDecoder).decode(this.proximityUUID.toBuffer()),this.uid=c(function(...e){const t=new Uint8Array(e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)));return e.forEach(((r,i)=>{t.set(r,i>0?e[i-1].byteLength:0)})),t}(this.proximityUUID.toBuffer(),Uint8Array.from([this.major]),Uint8Array.from([this.minor]))),this):this}};i([(0,_.SerializableMember)(),a("design:type",Number)],u.prototype,"major",void 0),i([(0,_.SerializableMember)(),a("design:type",Number)],u.prototype,"minor",void 0),i([(0,_.SerializableMember)(),a("design:type",b)],u.prototype,"proximityUUID",void 0),u=i([(0,_.SerializableObject)(),a("design:paramtypes",[D,Uint8Array])],u);class RelativeRSSIProcessing extends _.RelativePositionProcessing{constructor(e){super(E,e),this.options.propagationModel=this.options.propagationModel||R.LOG_DISTANCE}processRelativePositions(e,t){return new Promise((r=>{t.forEach(((t,r)=>{const i=this.convertToDistance(r,t);i&&e.addRelativePosition(i)})),r(e)}))}convertToDistance(e,t){const r=this.options.environmentFactor||t.environmentFactor,i=t.calibratedRSSI||this.options.defaultCalibratedRSSI;if(this.options.propagationModel!==R.LOG_DISTANCE);else if(i&&e.rssi&&r){const a=new _.RelativeDistance(t,Math.pow(10,(i-e.rssi)/(10*r)));return a.timestamp=e.timestamp,a.distanceUnit=_.LengthUnit.CENTIMETER,a}}}var R;!function(e){e[e.LOG_DISTANCE=0]="LOG_DISTANCE"}(R||(R={}));var f=r._H,m=r.JK,B=r.E7,y=r.SE,h=r.cf,g=r.kx,Y=r.oJ,U=r.dz,I=r.rV,O=r.VZ,M=r.mD,v=r.C1,C=r.Ah,N=r.Bu;export{f as BLEAltBeacon,m as BLEBeaconObject,B as BLEObject,y as BLEService,h as BLEUUID,g as BLEiBeacon,Y as MACAddress,U as PropagationModel,I as RFDataFrame,O as RFReceiverObject,M as RFTransmitterObject,v as RelativeRSSI,C as RelativeRSSIProcessing,N as WLANObject};
//# sourceMappingURL=openhps-rf.es.min.js.map